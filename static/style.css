/* ========= 全局 ========= */
:root{
  --bg1:#fff7d6;
  --bg2:#ffe3f2;
  --bg3:#dff1ff;
  --card: rgba(255,255,255,.78);
  --shadow: 0 16px 38px rgba(0,0,0,.14);
  --star:#ffd54a;
}

*{ box-sizing: border-box; }

body{
  margin:0;
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "PingFang SC", "Microsoft YaHei", sans-serif;
  background: radial-gradient(circle at top, var(--bg1), var(--bg2), var(--bg3));
  overflow:hidden;
  color:#222;
}

h1{ margin:0 0 14px; font-size:24px; }
.hint{ opacity:.72; margin-bottom:18px; font-size:14px; }

/* ========= 星星按钮（防止被通用 button 样式覆盖） ========= */
.star-btn{
  width:88px;
  height:88px;
  padding:0;
  border:none;
  border-radius:24px;
  background: rgba(255,255,255,.65);
  box-shadow: 0 12px 30px rgba(0,0,0,.12);
  cursor:pointer;
  display:grid;
  place-items:center;
  transition: transform .12s ease;
}

.star-btn:active{ transform: scale(.96); }

/* ========= 折叠时的轻微晃动（加在按钮上） ========= */
.star-btn.folding{
  animation: btnWiggle .55s ease;
}
@keyframes btnWiggle{
  0%{ transform: rotate(0) scale(1); }
  35%{ transform: rotate(2deg) scale(1.02); }
  70%{ transform: rotate(-2deg) scale(1.01); }
  100%{ transform: rotate(0) scale(1); }
}

/* ========= 可裂开的幸运星 ========= */
.star.openable{
  position: relative;
  width: 46px;
  height: 46px;
  /* 父级不画星星！只做容器 */
}

.star.openable .half{
  position:absolute;
  inset:0;
  background: var(--star);
  /* 五角星形状 */
  clip-path: polygon(
    50% 0%,
    61% 35%,
    98% 35%,
    68% 57%,
    79% 91%,
    50% 70%,
    21% 91%,
    32% 57%,
    2% 35%,
    39% 35%
  );
  filter: drop-shadow(0 6px 10px rgba(0,0,0,.18));
  transition: transform .6s cubic-bezier(.2,.8,.2,1), opacity .35s ease;
  z-index: 2;
}

/* 左右两半分别裁掉 */
.star.openable .left{
  clip-path: polygon(
    50% 0%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%
  );
  transform-origin: left center;
}

.star.openable .right{
  clip-path: polygon(
    50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%
  );
  transform-origin: right center;
}

/* 打开状态：左右分开 */
.star.openable.open .left{
  transform: translateX(-18px) rotate(-18deg);
}
.star.openable.open .right{
  transform: translateX(18px) rotate(18deg);
}

/* 中间闪光 */
.star.openable .shine{
  position:absolute;
  inset:-10px;
  background: radial-gradient(circle, rgba(255,255,255,.95), transparent 60%);
  opacity:0;
  transform: scale(.65);
  transition: opacity .22s ease, transform .22s ease;
  pointer-events:none;
  z-index: 3;
}

.star.openable.open .shine{
  opacity:1;
  transform: scale(1.25);
}

/* 复原状态 */
.star.openable.reset .half{
  transform:none;
  opacity:1;
}
.star.openable.reset .shine{
  opacity:0;
}

/* ========= 内容卡片 ========= */
.card{
  width:min(520px, 86vw);
  margin-top:22px;
  padding:18px 18px;
  border-radius:18px;
  background: var(--card);
  box-shadow: var(--shadow);
  backdrop-filter: blur(8px);
  display:none;
}

.card.show{
  display:block;
  animation: pop .28s ease;
}

@keyframes pop{
  from{ transform: translateY(8px); opacity:0; }
  to{ transform:none; opacity:1; }
}

.text{
  font-size:18px;
  line-height:1.65;
}

.img{
  width:100%;
  border-radius:14px;
  display:block;
}

/* ========= 历史 ========= */
.history{
  width:min(520px, 86vw);
  margin-top:14px;
  font-size:13px;
  opacity:.78;
}

.history ul{
  padding-left:18px;
  margin:8px 0 0;
}

.history li{
  margin:6px 0;
}

/* ========= 斜裂星星 ========= */
.star.openable{
  position: relative;
  width: 46px;
  height: 46px;
}

/* 两半都画五角星，但用 mask 做“斜切” */
.star.openable .half{
  position:absolute;
  inset:0;
  background: var(--star);
  clip-path: polygon(
    50% 0%,
    61% 35%,
    98% 35%,
    68% 57%,
    79% 91%,
    50% 70%,
    21% 91%,
    32% 57%,
    2% 35%,
    39% 35%
  );
  filter: drop-shadow(0 6px 10px rgba(0,0,0,.18));
  transition: transform .6s cubic-bezier(.2,.9,.2,1), opacity .35s ease;
  z-index:2;
}

/* 关键：用线性渐变当 mask，把星星沿斜线分成两半 */
.star.openable .left{
  -webkit-mask-image: linear-gradient(135deg, #000 0 49%, transparent 51% 100%);
          mask-image: linear-gradient(135deg, #000 0 49%, transparent 51% 100%);
  transform-origin: 20% 30%;
}
.star.openable .right{
  -webkit-mask-image: linear-gradient(135deg, transparent 0 49%, #000 51% 100%);
          mask-image: linear-gradient(135deg, transparent 0 49%, #000 51% 100%);
  transform-origin: 80% 70%;
}

/* 打开：沿斜方向分离 */
.star.openable.open .left{
  transform: translate(-18px,-14px) rotate(-20deg);
  opacity: .92;
}
.star.openable.open .right{
  transform: translate(18px,14px) rotate(20deg);
  opacity: .92;
}

/* 闪光 */
.star.openable .shine{
  position:absolute;
  inset:-14px;
  background: radial-gradient(circle, rgba(255,255,255,.95), transparent 60%);
  opacity:0;
  transform: scale(.6);
  transition: opacity .2s ease, transform .2s ease;
  z-index:3;
  pointer-events:none;
}
.star.openable.open .shine{
  opacity:1;
  transform: scale(1.25);
}

/* ========= 全屏弹层 ========= */
.modal{
  position: fixed;
  inset: 0;
  display: none;
  z-index: 999;
}
.modal.show{ display:block; }

.modal-backdrop{
  position:absolute;
  inset:0;
  background: rgba(0,0,0,.18);
  opacity:0;
  transition: opacity .25s ease;
}
.modal.show .modal-backdrop{ opacity:1; }

/* card 会从“星星中心点”缩放到全屏 */
.modal-card{
  position:absolute;
  left: var(--sx, 50%);
  top: var(--sy, 50%);
  width: min(720px, 92vw);
  max-height: 86vh;
  overflow:auto;

  border-radius: 20px;
  background: rgba(255,255,255,.88);
  backdrop-filter: blur(10px);
  box-shadow: 0 24px 60px rgba(0,0,0,.20);

  transform: translate(-50%, -50%) scale(.12);
  opacity: 0;
  transition: transform .42s cubic-bezier(.2,.9,.2,1), opacity .25s ease, left .42s cubic-bezier(.2,.9,.2,1), top .42s cubic-bezier(.2,.9,.2,1);
  transform-origin: center;
  padding: 18px 18px 16px;
}

/* show 时放大到“占据屏幕的中心卡片” */
.modal.show .modal-card{
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%) scale(1);
  opacity: 1;
}

/* 关闭按钮 */
.modal-close{
  position: sticky;
  top: 0;
  float: right;
  width: 38px;
  height: 38px;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  font-size: 22px;
  background: rgba(255,255,255,.9);
  box-shadow: 0 10px 22px rgba(0,0,0,.10);
}

/* 内容区 */
.modal-content{
  padding-top: 4px;
}
.modal-content .text{
  font-size: 20px;
  line-height: 1.75;
}
.modal-content img{
  width:100%;
  border-radius: 16px;
  display:block;
}

/* 底部信息与操作 */
.modal-foot{
  margin-top: 12px;
  opacity:.72;
  font-size: 13px;
}
.modal-actions{
  margin-top: 12px;
  display:flex;
  gap: 10px;
}
.modal-actions button{
  border:none;
  padding:10px 14px;
  border-radius: 12px;
  cursor:pointer;
  background: rgba(255,255,255,.9);
  box-shadow: 0 10px 22px rgba(0,0,0,.12);
}

/* ====== 背景漂浮微光（低调） ====== */
.bg-glow{
  position: fixed;
  inset: -20vh -20vw;
  pointer-events:none;
  z-index: 0;
  background:
    radial-gradient(circle at 20% 30%, rgba(255,255,255,.35), transparent 35%),
    radial-gradient(circle at 70% 20%, rgba(255,255,255,.25), transparent 40%),
    radial-gradient(circle at 60% 80%, rgba(255,255,255,.20), transparent 38%);
  filter: blur(10px);
  animation: glowMove 10s ease-in-out infinite alternate;
}
@keyframes glowMove{
  from{ transform: translate3d(-1%, -1%, 0) scale(1); }
  to{ transform: translate3d(1%, 1%, 0) scale(1.02); }
}

/* 让你的主体内容在背景上方 */
body > * { position: relative; z-index: 1; }

/* ====== 星星裂开时的小粒子容器 ====== */
.particles{
  position:absolute;
  inset: 0;
  pointer-events:none;
  z-index: 4;
}

.p{
  position:absolute;
  left: 50%;
  top: 50%;
  width: 8px;
  height: 8px;
  border-radius: 999px;
  background: rgba(255,255,255,.95);
  box-shadow: 0 0 12px rgba(255,255,255,.65);
  transform: translate(-50%, -50%) scale(1);
  opacity: 0;
}

/* 粒子飞散动画 */
@keyframes popFly{
  0%   { transform: translate(-50%, -50%) scale(.6); opacity: 0; }
  20%  { opacity: 1; }
  100% { transform: translate(calc(-50% + var(--dx)), calc(-50% + var(--dy))) scale(0.1); opacity: 0; }
}

/* ====== 弹层更精致：渐变边框 + 更顺滑的缩放 ====== */
.modal-card{
  border: 1px solid rgba(255,255,255,.55);
  background:
    linear-gradient(180deg, rgba(255,255,255,.92), rgba(255,255,255,.80));
}

.modal-card::before{
  content:"";
  position:absolute;
  inset:-1px;
  border-radius: 20px;
  background: linear-gradient(135deg, rgba(255,255,255,.70), rgba(255,213,74,.25), rgba(255,92,168,.18));
  z-index:-1;
  filter: blur(10px);
  opacity:.7;
}

/* 内容排版更舒服 */
.modal-content .text{
  font-size: 20px;
  line-height: 1.75;
  letter-spacing: .2px;
}
.modal-foot{
  display:flex;
  justify-content: space-between;
  gap: 10px;
}

/* 关闭按钮更“礼物”一点 */
.modal-close{
  background: rgba(255,255,255,.92);
}

/* ====== 合照轮播背景（虚化+半透明） ====== */
.photo-bg{
  position: fixed;
  inset: 0;
  z-index: 0;
  pointer-events: none;
  overflow: hidden;
}

/* 两层背景，用 opacity 做交叉淡入淡出 */
.photo-bg__layer{
  position: absolute;
  inset: -6vh -6vw;           /* 放大一点，避免 blur 出现边缘露黑 */
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;

  filter: blur(4px);
  transform: scale(1.08);     /* blur 后再放大一点更自然 */
  opacity: 0;
  transition: opacity 1.2s ease;
}

/* 当前显示那层 */
.photo-bg__layer.is-on{
  opacity: .55;               /* 透明度：你想更明显就调到 0.7，想更淡就 0.4 */
}

/* 柔光纱：让背景更奶、更不抢戏 */
.photo-bg__veil{
  position:absolute;
  inset:0;
  background: radial-gradient(circle at top, rgba(255,255,255,.55), rgba(255,255,255,.30));
  mix-blend-mode: screen;
  opacity: .55;
}

/* 确保前景内容在背景上方 */
body > *{
  position: relative;
  z-index: 1;
}

/* ====== 回复框 ====== */
.replyBox{
  width:min(520px,86vw);
  margin-top:18px;
}

.replyTitle{
  font-size:14px;
  opacity:.75;
  margin-bottom:8px;
}

.replyRow{
  display:flex;
  gap:10px;
}

.replyRow input{
  flex:1;
  padding:12px 14px;
  border-radius:12px;
  border:1px solid rgba(0,0,0,.12);
  background:rgba(255,255,255,.75);
  outline:none;
  font-size:14px;
}

.replyRow button{
  padding:12px 14px;
  border-radius:12px;
  border:none;
  cursor:pointer;
  background:rgba(255,255,255,.9);
  box-shadow:0 10px 22px rgba(0,0,0,.12);
}

.replyTip{
  margin-top:6px;
  font-size:12px;
  opacity:.7;
}
